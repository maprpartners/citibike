<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Managing Cluster Authentication - Amazon EKS</title>
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <link rel="home" href="#top" />
      <link rel="up" href="what-is-eks.html" title="What Is Amazon EKS?" />
      <link rel="prev" href="eks-networking.html" title="Amazon EKS Networking" />
      <link rel="next" href="service_limits.html" title="Amazon EKS Service Limits" />
      <meta name="description" content="Manage authentication for your Amazon EKS cluster." />
      <meta name="deployment_region" content="IAD" />
      <meta name="product" content="Amazon EKS" />
      <meta name="guide" content="User Guide" />
      <meta name="guide-locale" content="en_us" />
      <link rel="icon" type="image/ico" href="images/favicon.ico" />
      <link rel="shortcut icon" type="image/ico" href="images/favicon.ico" />
      <link rel="canonical" href="https://docs.aws.amazon.com/eks/latest/userguide/managing-users.html" />
      <link rel="stylesheet" type="text/css" href="css/jquery-ui.min.css" />
      <link rel="stylesheet" type="text/css" href="font/css/font-awesome.min.css" />
      <link rel="stylesheet" type="text/css" href="css/google-font.css" />
      <link id="code-style" rel="stylesheet" type="text/css" href="css/code/light.css" />
      <link rel="stylesheet" type="text/css" href="css/jquery-ui.theme.css" />
      <link rel="stylesheet" type="text/css" href="css/colorbox.css" />
      <link rel="stylesheet" type="text/css" href="css/awsdocs.css?v=20170615" /><script type="text/javascript" src="js/highlight.pack.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/jquery-ui.min.js"></script><script type="text/javascript" src="js/handlebars.js"></script><script type="text/javascript" src="js/jquery.colorbox.js"></script><script type="text/javascript" src="js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      <div xmlns:db="http://docbook.org/ns/docbook" id="aws-nav" class="aws-nav-header">
         <div class="aws-nav-header-left">
            <div class="aws-nav-logo">
               <!--aws_logo_105x39.png--><a href="http://aws.amazon.com"><img src="images/aws_logo_105x39.png" alt="Amazon Web Services" /></a></div>
         </div>
         <div id="aws-nav-header-right" class="aws-nav-header-right">
            <div class="aws-nav-cta-button-outer"><a id="aws-nav-cta-button" class="aws-nav-button" href="https://console.aws.amazon.com/console/home">Sign In to the Console</a></div>
            <div class="aws-nav-popover-trigger" data-dropdown="aws-nav-dropdown-lang"><select id="languageSelection" onchange="SelectLanguage()">
                  <option value="/de_de/eks/latest/userguide/managing-users.html">Deutsch</option>
                  <option value="/en_us/eks/latest/userguide/managing-users.html" selected="selected">English</option>
                  <option value="/es_es/eks/latest/userguide/managing-users.html">Español</option>
                  <option value="/fr_fr/eks/latest/userguide/managing-users.html">Français</option>
                  <option value="/it_it/eks/latest/userguide/managing-users.html">Italiano</option>
                  <option value="/ja_jp/eks/latest/userguide/managing-users.html">日本語</option>
                  <option value="/ko_kr/eks/latest/userguide/managing-users.html">한국어</option>
                  <option value="/pt_br/eks/latest/userguide/managing-users.html">Português</option>
                  <option value="/zh_cn/eks/latest/userguide/managing-users.html">中文 (简体)</option>
                  <option value="/zh_tw/eks/latest/userguide/managing-users.html">中文 (繁體)</option></select></div><a class="btn btn-pdf-link" id="pdf-link-top" href="eks-ug.pdf#managing-users" target="_blank" style="background-image: url(&#34;images/Adobe_PDF_icon.png&#34;)" title="Open PDF"></a><div id="aws-nav-quicklinks-separator" class="aws-nav-quicklinks-separator">
               <div class="aws-nav-left"></div>
               <div class="aws-nav-right"></div>
            </div>
         </div>
         <div xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" id="topnav-flyout-menu-container">
            <ul id="topnav-flyout-menu"><script id="flyout-item-template" type="text/x-handlebars-template">           
                    {{#flyoutList}}
                    
                    <li>{{listItem}}
                        {{#if subList}}
                        <ul>
                            {{#subList}}
                            <li class="awsdocs-flyout-link-wrapper"><a href="{{target}}">{{text}}</a></li>
                            {{/subList}}
                        </ul>
                        {{/if}}
                    </li>
                    
                    {{/flyoutList}}
                </script></ul>
            <div id="topnav-flyout-menu-spacer"></div>
         </div>
      </div>
      <div id="content-container">
         <div id="left-column">
            <div id="left-col-header">
               <div xmlns:db="http://docbook.org/ns/docbook" id="left-col-top-content">
                  <div id="service-name">Amazon EKS </div>
                  <div id="search"><i id="search-icon" class="fa fa-search fa-2x"></i></div>
                  <div id="guide-info">User Guide
                     <div id="content-button"><i id="toggle-contents" class="fa fa-bars"></i></div>
                  </div>
               </div>
               <form id="finegrainedSearch" method="get" onsubmit="return searchFormSubmit(this);" action="/search/doc-search.html">
                  <div id="search-form"><select id="search-select" name="searchPath">
                        <option value="all">Entire Site</option>
                        <option value="AWSMarketplace">AMIs from AWS Marketplace</option>
                        <option value="amis">AMIs from All Sources</option>
                        <option value="articles">Articles &amp; Tutorials</option>
                        <option value="products_and_info">AWS Product Information</option>
                        <option value="case_studies">Case Studies</option>
                        <option value="customerapps">Customer Apps</option>
                        <option value="documentation">Documentation</option>
                        <option value="documentation-product">Documentation - This Product</option>
                        <option value="documentation-guide" selected="selected">Documentation - This Guide</option>
                        <option value="datasets">Public Data Sets</option>
                        <option value="releasenotes">Release Notes</option>
                        <option value="solution_providers">Partners</option>
                        <option value="code">Sample Code &amp; Libraries</option></select><br /><input id="search-query" name="searchQuery" type="text" placeholder="Search" /><input id="search-button" src="images/search-button.png" alt="Go" type="image" /></div><input type="hidden" name="this_doc_product" id="this_doc_product" value="Amazon EKS" /><input type="hidden" name="this_doc_guide" id="this_doc_guide" value="User Guide" /><input type="hidden" name="doc_locale" value="en_us" /></form>
            </div>
            <div id="toc">
               <ul class="awstoc">
                  <li class="awstoc leaf"><a class="awstoc" href="what-is-eks.html">What Is Amazon EKS?</a></li>
                  <li class="awstoc leaf"><a class="awstoc" href="preview-considerations.html">Preview Considerations</a></li>
                  <li class="awstoc leaf"><a class="awstoc" href="getting-started.html">Getting Started</a></li>
                  <li class="awstoc leaf"><a class="awstoc" href="storage-classes.html">Storage Classes</a></li>
                  <li class="awstoc leaf"><a class="awstoc" href="eks-networking.html">Networking</a></li>
                  <li class="awstoc leaf"><a class="awstoc selected" href="managing-users.html">Managing Cluster Authentication</a></li>
                  <li class="awstoc leaf"><a class="awstoc" href="service_limits.html">Service Limits</a></li>
                  <li class="awstoc leaf"><a class="awstoc" href="EKS-Doc-SubscribeTopic.html">Subscribing to EKS Doc Updates</a></li>
                  <li class="awstoc closed"><a class="awstoc" href="IAM_policies.html">IAM Policies, Roles, and Permissions</a><ul class="awstoc">
                        <li class="awstoc leaf"><a class="awstoc" href="iam-policy-structure.html">Policy Structure</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="EKS_IAM_user_policies.html">Creating IAM Policies</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="service_IAM_role.html">Amazon EKS Service IAM Role</a></li>
                     </ul>
                  </li>
                  <li class="awstoc leaf"><a class="awstoc" href="dashboard-tutorial.html">Tutorial: Deploy Kubernetes Dashboard</a></li>
                  <li class="awstoc leaf"><a class="awstoc" href="create-public-private-vpc.html">Tutorial: Creating a VPC for Amazon EKS</a></li>
                  <li class="awstoc leaf"><a class="awstoc" href="doc-history.html">Document History</a></li>
                  <li class="awstoc leaf"><a class="awstoc" href="glossary.html">AWS Glossary</a></li>
                  <li id="toc-additional-links"><a class="btn btn-pdf-link" id="pdf-link-alt" href="eks-ug.pdf#top" target="_blank" style="background-image: url(&#34;images/Adobe_PDF_icon.png&#34;)" title="Open PDF"></a></li>
               </ul>
            </div>
         </div>
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> » <a href="http://aws.amazon.com/documentation/eks">Amazon EKS</a> » <a href="index.html">User Guide</a> » <span class="breadcrumb">Managing Cluster Authentication</span></div>
                           </td>
                        </tr>
                     </table>
                     <div>
                        <div id="awsdocs-banner-info">
                           <p><em><b>This prerelease documentation is
                                    confidential and is provided under the terms of your nondisclosure agreement with
                                    Amazon Web Services (AWS) or other agreement governing your receipt of AWS confidential
                                    information.</b></em></p>
                        </div>
                     </div>
                     <h1 class="topictitle" id="managing-users">Managing Cluster Authentication</h1>
                     <p>Amazon EKS uses IAM to provide authentication to your Kubernetes cluster (through
                        the <a href="https://github.com/heptio/authenticator" target="_blank">Heptio Authenticator</a>), but it
                        still relies on native Kubernetes <a href="https://kubernetes.io/docs/admin/authorization/rbac/" target="_blank">Role Based Access
                           Control</a> (RBAC) for authorization. This means that IAM is only used for
                        authentication of valid IAM entities. All permissions for interacting with your Amazon
                        EKS
                        cluster’s Kubernetes API is managed through the native Kubernetes RBAC system.
                     </p>
                     <div class="mediaobject">
                        
                        <img src="images/eks-iam.png" alt="&#xA;            Amazon EKS and IAM integration&#xA;        " />
                        
                        
                        
                     </div>
                     <p>When you create an Amazon EKS cluster, your IAM user is automatically granted
                        <code class="code">system:master</code> permissions in the cluster's RBAC configuration. To grant
                        additional AWS users the ability to interact with your cluster, you must edit the
                        <code class="code">aws-auth</code> ConfigMap within Kubernetes.
                     </p>
                     <p class="title"><b>To add an IAM user or role to an Amazon EKS cluster</b></p>
                     <ol>
                        <li>
                           
                           <p>Ensure that the AWS credentials that <b>kubectl</b> is using are
                              already authorized for your cluster.  The IAM user that created the cluster has
                              these permissions by default.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Open the <code class="code">aws-auth</code> ConfigMap.
                           </p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><strong class="userinput"><code>kubectl edit configmap/aws-auth</code></strong></code></pre>
                           <div class="aws-note">
                              <p class="aws-note">Note</p>
                              <p>If your default text editor does not wait for you to finish editing before
                                 returning to the command prompt, you see the following error:
                              </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Edit cancelled, no changes made.</code></pre><p>You can switch your default text editor to a different editor, such as
                                 <b>vim</b>, or you can configure your default editor to wait
                                 until you are finished editing the file.
                              </p>
                           </div>
                           
                           <p>Example ConfigMap:</p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"># Please edit the object below. Lines beginning with a '#' will be ignored,
# and an empty file will abort the edit. If an error occurs while saving this file will be
# reopened with the relevant failures.
#
apiVersion: v1
data:
  mapRoles: |
    - rolearn: arn:aws:iam::<em class="replaceable"><code>111122223333</code></em>:role/doc-test-worker-nodes-NodeInstanceRole-WDO5P42N3ETB
      username: system:node:{{EC2PrivateDNSName}}
      groups:
        - system:bootstrappers
        - system:nodes
        - system:node-proxier
kind: ConfigMap
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"v1","data":{"mapRoles":"- rolearn: arn:aws:iam::<em class="replaceable"><code>111122223333</code></em>:role/doc-test-worker-nodes-NodeInstanceRole-WDO5P42N3ETB\n  username: system:node:{{EC2PrivateDNSName}}\n  groups:\n    - system:bootstrappers\n    - system:nodes\n    - system:node-proxier\n"},"kind":"ConfigMap","metadata":{"annotations":{},"name":"aws-auth","namespace":"default"}}
  creationTimestamp: 2018-04-04T18:49:10Z
  name: aws-auth
  namespace: default
  resourceVersion: "780"
  selfLink: /api/v1/namespaces/default/configmaps/aws-auth
  uid: dcc31de5-3838-11e8-af26-02e00430057c</code></pre>
                           </li>
                        <li>
                           
                           <p>Add your IAM users, roles, or AWS accounts to the configMap.</p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p><b>To add an IAM user:</b> add the user
                                       details to the <code class="code">mapUsers</code> section of the ConfigMap, under
                                       <code class="code">data</code>. Add this section if it does not already exist in the
                                       file. Each entry supports the following parameters:
                                    </p>
                                    
                                    <div class="itemizedlist">
                                       
                                       
                                       
                                       
                                       <ul class="itemizedlist" type="disc">
                                          <li class="listitem">
                                             
                                             <p><b>userarn</b>: The ARN of the IAM user to
                                                add.
                                             </p>
                                             
                                          </li>
                                          <li class="listitem">
                                             
                                             <p><b>username</b>: The user name within Kubernetes to
                                                map to the IAM user. By default, the user name is the ARN of the
                                                IAM user.
                                             </p>
                                             
                                          </li>
                                          <li class="listitem">
                                             
                                             <p><b>groups</b>: A list of groups within Kubernetes to
                                                which the user is mapped to.
                                             </p>
                                             
                                          </li>
                                       </ul>
                                    </div>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p><b>To add an IAM role:</b> add the role
                                       details to the <code class="code">mapRoles</code> section of the ConfigMap, under
                                       <code class="code">data</code>. Add this section if it does not already exist in the
                                       file. Each entry supports the following parameters:
                                    </p>
                                    
                                    <div class="itemizedlist">
                                       
                                       
                                       
                                       
                                       <ul class="itemizedlist" type="disc">
                                          <li class="listitem">
                                             
                                             <p><b>rolearn</b>: The ARN of the IAM role to
                                                add.
                                             </p>
                                             
                                          </li>
                                          <li class="listitem">
                                             
                                             <p><b>username</b>: The user name within Kubernetes to
                                                map to the IAM role. By default, the user name is the ARN of the
                                                IAM role.
                                             </p>
                                             
                                          </li>
                                          <li class="listitem">
                                             
                                             <p><b>groups</b>: A list of groups within Kubernetes to
                                                which the role is mapped to.
                                             </p>
                                             
                                          </li>
                                       </ul>
                                    </div>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p><b>To add an AWS account to be automapped:</b>
                                       add the AWS account ID (enclosed in quotation marks) to the
                                       <code class="code">mapAccounts</code> section of the ConfigMap, under
                                       <code class="code">data</code>. Add this section if it does not already exist in the
                                       file. Every AWS user and AWS role in that account is automatically
                                       mapped to a user in the Kubernetes cluster with the Amazon Resource Name (ARN) of
                                       that user
                                       or role as the <code class="code">username</code>. However, no permissions are provided
                                       in RBAC by this action alone;  you must still create role bindings in your
                                       cluster to provide these entities permissions.
                                    </p>
                                    
                                 </li>
                              </ul>
                           </div>
                           
                           <p>For example, the block below contains:</p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p>A <code class="code">mapRoles</code> section that adds the worker node instance role so
                                       that worker nodes can register themselves with the cluster.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>A <code class="code">mapUsers</code> section with the AWS users <code class="code">admin</code> from
                                       the default AWS account, and <code class="code">ops-user</code> from another AWS
                                       account. Both users are added to the <code class="code">system:masters</code>
                                       group.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>A <code class="code">mapAccounts</code> section with the AWS account,
                                       <em class="replaceable"><code>111122223333</code></em>.
                                    </p>
                                    
                                 </li>
                              </ul>
                           </div>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="yaml "># Please edit the object below. Lines beginning with a '#' will be ignored,
# and an empty file will abort the edit. If an error occurs while saving this file will be
# reopened with the relevant failures.
#
apiVersion: v1
data:
  mapRoles: |
    - rolearn: <em class="replaceable"><code>arn:aws:iam::555555555555:role/preview-worker-nodes-NodeInstanceRole-74RF4UBDUKL6</code></em>
      username: <em class="replaceable"><code>system:node:{{EC2PrivateDNSName}}</code></em>
      groups:
        - <em class="replaceable"><code>system:bootstrappers</code></em>
        - <em class="replaceable"><code>system:nodes</code></em>
        - <em class="replaceable"><code>system:node-proxier</code></em>
  mapUsers: |
    - userarn: <em class="replaceable"><code>arn:aws:iam::555555555555:user/admin</code></em>
      username: <em class="replaceable"><code>admin</code></em>
      groups:
        - <em class="replaceable"><code>system:masters</code></em>
    - userarn: <em class="replaceable"><code>arn:aws:iam::111122223333:user/ops-user</code></em>
      username: <em class="replaceable"><code>ops-user</code></em>
      groups:
        - <em class="replaceable"><code>system:masters</code></em>
  mapAccounts: |
    - <em class="replaceable"><code>"111122223333"</code></em></code></pre>
                           </li>
                        <li>
                           
                           <p>Save the file and exit your text editor.</p>
                           
                        </li>
                     </ol>
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="eks-networking.html">« Previous </a><a class="awstoc" accesskey="n" href="service_limits.html">Next »</a></div>
                     <div id="copyright-main-footer">© 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper"></div>
            </div>
         </div>
      </div>
      <div id="footer">
         <div id="footer_short_fb" class="hide" title="Feedback"><a target="_blank" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?feedback_destination_id=5a08f8e9-7260-49e4-bac3-ada98f265157&amp;topic_url=http://docs.aws.amazon.com/en_us/eks/latest/userguide/managing-users.html&amp;hidden_guide_name=User Guide&amp;hidden_api_version=&amp;hidden_file_name=managing-users"><i class="fa fa-envelope-o"></i></a></div>
         <div id="footer_toggle" class="mediaobject"><img id="footer_toggle_img" src="images/expanderarrow.png" /><img id="footer_toggle_img_collapse" class="hide" src="images/expanderarrowright.png" /></div>
         <div id="footer-left"><a target="_top" href="http://aws.amazon.com/terms">Terms of Use</a> | <a target="_top" href="http://aws.amazon.com/privacy">Privacy</a> | © 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.
         </div>
         <div id="footer-right">
            <div id="feedback">
               <div id="forums"></div>
               <div id="feedback-message">Did this page help you?</div>
               <div id="feedback-yesno-buttons"><a class="awstoc btn btn-default" target="_blank" href="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/eks/latest/userguide/managing-users.html">Yes</a><a class="awstoc btn btn-default" target="_blank" href="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/eks/latest/userguide/managing-users.html">No</a></div>
               <div id="feedback-feedback-button"><a class="awstoc btn btn-default" target="_blank" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?feedback_destination_id=5a08f8e9-7260-49e4-bac3-ada98f265157&amp;topic_url=http://docs.aws.amazon.com/en_us/eks/latest/userguide/managing-users.html&amp;hidden_guide_name=User Guide&amp;hidden_api_version=&amp;hidden_file_name=managing-users">Feedback</a></div>
            </div>
         </div>
      </div>
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon EKS';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='User Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   </body>
</html>